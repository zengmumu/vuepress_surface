<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端面试宝典 | DNS解析 </title>
    <meta name="description" content="前端面试宝典">
    
    
    <link rel="preload" href="/vuepress_surface/assets/css/18.styles.420012bd.css" as="style"><link rel="preload" href="/vuepress_surface/assets/js/app.4a5dd37d.js" as="script"><link rel="preload" href="/vuepress_surface/assets/js/15.d69d29cc.js" as="script"><link rel="prefetch" href="/vuepress_surface/assets/js/10.a5674993.js"><link rel="prefetch" href="/vuepress_surface/assets/js/1.afc5ed66.js"><link rel="prefetch" href="/vuepress_surface/assets/js/2.8397d15a.js"><link rel="prefetch" href="/vuepress_surface/assets/js/3.9fe92e39.js"><link rel="prefetch" href="/vuepress_surface/assets/js/4.fc031f56.js"><link rel="prefetch" href="/vuepress_surface/assets/js/5.1f88dc10.js"><link rel="prefetch" href="/vuepress_surface/assets/js/6.18bc6a86.js"><link rel="prefetch" href="/vuepress_surface/assets/js/7.4823b6ce.js"><link rel="prefetch" href="/vuepress_surface/assets/js/8.f5d7b110.js"><link rel="prefetch" href="/vuepress_surface/assets/js/9.2534d9d1.js"><link rel="prefetch" href="/vuepress_surface/assets/js/0.7bbcbf36.js"><link rel="prefetch" href="/vuepress_surface/assets/js/11.1263fd6d.js"><link rel="prefetch" href="/vuepress_surface/assets/js/12.9a787179.js"><link rel="prefetch" href="/vuepress_surface/assets/js/13.7d45aeb5.js"><link rel="prefetch" href="/vuepress_surface/assets/js/14.e5037f79.js"><link rel="prefetch" href="/vuepress_surface/assets/js/16.366b0ce7.js"><link rel="prefetch" href="/vuepress_surface/assets/js/17.b15fa826.js">
    <link rel="stylesheet" href="/vuepress_surface/assets/css/18.styles.420012bd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/vuepress_surface/" class="home-link router-link-active"><!----><span class="site-name">
      前端面试宝典
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress_surface/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/zhaodianlong" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress_surface/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/zhaodianlong" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><!----></nav><ul class="sidebar-links"><li><a href="/vuepress_surface/" class="sidebar-link">常见问题</a></li><li><a href="/vuepress_surface/Regexp.html" class="sidebar-link">常见正则</a></li><li><a href="/vuepress_surface/Cache.html" class="sidebar-link">HTTP缓存机制</a></li><li><a href="/vuepress_surface/HttpAndHttps.html" class="sidebar-link">浅析HTTP和HTTPS</a></li><li><a href="/vuepress_surface/HttpMethod.html" class="sidebar-link">Get与Post区别</a></li><li><a href="/vuepress_surface/Dns.html" class="active sidebar-link">DNS解析原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress_surface/Dns.html#递归查询" class="sidebar-link">递归查询</a></li><li class="sidebar-sub-header"><a href="/vuepress_surface/Dns.html#迭代查询" class="sidebar-link">迭代查询</a></li></ul></li><li><a href="/vuepress_surface/Tcp3.html" class="sidebar-link">TCP握手协议(三次握手)</a></li><li><a href="/vuepress_surface/Tcp4.html" class="sidebar-link">连接终止协议(四次挥手)</a></li><li><a href="/vuepress_surface/Vue2018.html" class="sidebar-link">Vue常见问题</a></li><li><a href="/vuepress_surface/Url.html" class="sidebar-link">输入URL到显示页面的流程</a></li><li><a href="/vuepress_surface/Felx.html" class="sidebar-link">Flex布局</a></li><li><a href="/vuepress_surface/Boolean.html" class="sidebar-link">布尔操作符</a></li><li><a href="/vuepress_surface/RedrawRefulx.html" class="sidebar-link">重绘和回流</a></li><li><a href="/vuepress_surface/PageRendering.html" class="sidebar-link">页面渲染原理</a></li><li><a href="/vuepress_surface/HttpCode.html" class="sidebar-link">常见HTTP状态码</a></li><li><a href="/vuepress_surface/Hack.html" class="sidebar-link">常见兼容问题及解决方案</a></li><li><a href="/vuepress_surface/VerticalCenter.html" class="sidebar-link">垂直居中的几种方法</a></li><li><a href="/vuepress_surface/Trigon.html" class="sidebar-link">CSS实现三角形</a></li></ul></div><div class="page"><div class="content"><h1 id="dns解析"><a href="#dns解析" aria-hidden="true" class="header-anchor">#</a> DNS解析</h1><p>DNS解析本质是域名到ip的过程。将域名发送到DNS请求报文中，以UDP用户数据报的方式，发送到本地域名服务器，服务器查找结束后，把对应的ip地址发回给主机。</p><h2 id="递归查询"><a href="#递归查询" aria-hidden="true" class="header-anchor">#</a> 递归查询</h2><h3 id="步骤："><a href="#步骤：" aria-hidden="true" class="header-anchor">#</a> 步骤：</h3><pre><code>1.客户端向本机配置的本地名称服务器（在此仅以首选DNS服务器为例进行介绍，所配置其它备用DNS服务器的解析流程完全一样）发出DNS域名查询请求。 
2.本地名称服务器收到请求后，先查询本地的缓存，如果有该域名的记录项，则本地名称服务器就直接把查询的结果返回给客户端；如果本地缓存中没有该域名的记录，则本地名称服务器再以DNS客户端的角色发送与前面一样的DNS域名查询请求发给根名称服务器。
3.根名称服务器收到DNS请求后，把所查询得到的所请求的DNS域名中顶级域名所对应的顶级名称服务器地址返回给本地名称服务器。
4.本地名称服务器根据根名称服务器所返回的顶级名称服务器地址，向对应的顶级名称服务器发送与前面一样的DNS域名查询请求。 
5.对应的顶级名称服务器在收到DNS查询请求后，也是先查询自己的缓存，如果有所请求的DNS域名的记录项，则相接把对应的记录项返回给本地名称服务器，然后再由本地名称服务器返回给DNS客户端，否则向本地名称服务器返回所请求的DNS域名中的二级域名所对应的二级名称服务器地址。  
</code></pre><p>然后本地名称服务器继续按照前面介绍的方法一次次地向三级、四级名称服务器查询，直到最终的对应域名所在区域的权威名称服务器返回到最终的记录给本地名称服务器。然后再由本地名称服务器返回给DNS客户，同时本地名称服务器会缓存本次查询得到的记录项。</p><h2 id="迭代查询"><a href="#迭代查询" aria-hidden="true" class="header-anchor">#</a> 迭代查询</h2><h3 id="步骤"><a href="#步骤" aria-hidden="true" class="header-anchor">#</a> 步骤</h3><pre><code>1.客户端向本机配置的本地名称服务器（在此仅以首先DNS服务器为例进行介绍，其它备用DNS服务器的解析流程完全一样）发出DNS域名查询请求。  
2.本地名称服务器收到请求后，先查询本地的缓存，如果有该域名的记录项，则本地名称服务器就直接把查询的结果返回给客户端；如果本地缓存中没有该域名的记录，则向DNS客户端返回一条DNS应答报文，报文中会给出一些参考信息，如本地名称服务器上的根名称服务器地址等。  
3.DNS客户端在收到本地名称服务器的应答报文后，会根据其中的根名称服务器地址信息，向对应的根名称服务器再次发出与前面一样的DNS查询请求报文。  
4.根名称服务器在收到DNS查询请求报文后，通过查询自己的DNS数据库得到请求DNS域名中顶级域名所对应的顶级名称服务器信息，然后以一条DNS应答报文返回给DNS客户端。   
5.DNS客户端根据来自根名称服务器应答报文中的对应顶级名称服务器地址信息，向该顶级名称服务器发出与前面一样的DNS查询请求报文。
6.顶级名称服务器在收到DNS查询请求后，先查询自己的缓存，如果有所请求的DNS域名的记录项，则相接把对应的记录项返回给DNS客户端，否则通过查询后把对应域名中二级域名所对应的二级名称服务器地址信息以一条DNS应答报文返回给DNS客户端。
</code></pre><p>然后DNS客户端继续按照前面介绍的方法一次次地向三级、四级名称服务器查询，直到最终的权威名称服务器返回到最终的记录。</p><p><strong>Q:什么时候用到递归查询，什么时候用到迭代查询？</strong><br>
当所配置的本地名称服务器解析不了时，后面的查询工作是由本地名称服务器替代DNS客户端进行的（以“本地名称服务器”为中心），只需要本地名称服务器向DNS客户端返回最终的查询结果即可。而本节所介绍的DNS迭代名称解析（或者叫“迭代查询”）的所有查询工作全部是DNS客户端自己进行（以“DNS客户端”自己为中心）。在条件之一满足时就会采用迭代名称解析方式：</p><ol><li>在查询本地名称服务器时，如果客户端的请求报文中没有申请使用递归查询，即在DNS请求报头部的RD字段没有置1。相当于说“你都没有主动要求我为你进行递归查询，我当然不会为你工作了”。</li><li>客户端在DNS请求报文中申请使用的是递归查询（也就是RD字段置1了），但在所配置的本地名称服务器上是禁用递归查询（DNS服务器一般默认支持递归查询的），即在应答DNS报文头部的RA字段置0。</li></ol></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/vuepress_surface/HttpMethod.html" class="prev">
          Get与Post区别
        </a></span><span class="next"><a href="/vuepress_surface/Tcp3.html">
          TCP握手协议(三次握手)
        </a> →
      </span></p></div></div></div></div>
    <script src="/vuepress_surface/assets/js/15.d69d29cc.js" defer></script><script src="/vuepress_surface/assets/js/app.4a5dd37d.js" defer></script>
  </body>
</html>
